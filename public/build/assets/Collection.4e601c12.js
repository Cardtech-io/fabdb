import{n as o,a as l,c as u,R as p,i as m,I as h,e as v,H as g,m as _}from"./app.7bdea8e6.js";import{C as f}from"./CardSearch.dd46988b.js";import{Q as y}from"./AdvancedCardSearch.2b6643af.js";import{P as b}from"./Paginator.315a7948.js";import{C as x}from"./Colour.7eb81ff4.js";import{S as k}from"./Sorter.c1f55e85.js";const w={props:["sku","count"],data(){return{save:null,total:0}},methods:{add:function(){this.$emit("card-added",this.type),this.total+=1,this.save&&clearTimeout(this.save),this.save=setTimeout(()=>{l.post("/collection/",{sku:this.sku,total:this.total}),this.total=0},1e3)}}};var C=function(){var t=this,e=t._self._c;return e("button",{staticClass:"py-2 w-1/3 rounded sm:hover:bg-secondary active:bg-primary sm:hover:text-white",on:{click:t.add}},[t._v("+")])},$=[],R=o(w,C,$,!1,null,null,null,null);const T=R.exports,A={props:["sku","count"],data(){return{save:null,total:0}},computed:{classes:function(){return{"link-alternate":!this.disabled,"text-gray-400":this.disabled,"cursor-not-allowed":this.disabled}},disabled:function(){return this.count===0}},methods:{remove:function(){this.disabled||(this.$emit("card-removed",this.type),this.total+=1,this.save&&clearTimeout(this.save),this.save=setTimeout(()=>{l.delete("/collection/"+this.sku+"?total="+this.total),this.total=0},1e3))}}};var F=function(){var t=this,e=t._self._c;return e("button",{staticClass:"py-2 w-1/3 rounded",class:{"sm:hover:bg-secondary active:bg-primary sm:hover:text-white":t.count>0,"text-gray-400":t.count===0},attrs:{disabled:t.disabled},on:{click:t.remove}},[t._v("-")])},P=[],S=o(A,F,P,!1,null,null,null,null);const I=S.exports,M={props:["printing"],components:{Add:T,Remove:I},data(){return{index:this.$root.collectionTabIndex}},computed:{total:{get(){return this.printing.total},set(s){this.printing.total=s,setTimeout(this.save,2e3)}}},methods:{decrement:function(s){this.printing.total-1<0||(this.printing.total-=1)},increment:function(s){this.printing.total+=1},save(){let s={sku:this.printing.sku.sku,type:this.type,total:this.total};l.put("/collection/",s)}},beforeCreate(){this.$root.collectionTabIndex+=1}};var N=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex items-center mx-auto"},[e("remove",{attrs:{sku:t.printing.sku.sku,count:t.total},on:{"card-removed":t.decrement}}),e("div",{staticClass:"w-1/3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.total,expression:"total"}],staticClass:"w-full bg-white dark:bg-gray-900 text-center outline-none focus:bg-white p-2",attrs:{type:"text",tabindex:t.index},domProps:{value:t.total},on:{input:function(r){r.target.composing||(t.total=r.target.value)}}})]),e("add",{attrs:{sku:t.printing.sku.sku,count:t.total},on:{"card-added":t.increment}})],1)},z=[],Q=o(M,N,z,!1,null,null,null,null);const H=Q.exports,q={components:{CardCount:H,Colour:x,Icon:u,RaritySymbol:p},mixins:[m,h],props:{printing:Object},methods:{toggle(s,t){l.post("/collection/"+s.sku.sku+"/"+t)}}};var j=function(){var t=this,e=t._self._c;return e("tr",{staticClass:"odd:bg-gray-100 hover:bg-gray-300 dark:odd:bg-gray-700 group dark:hover:bg-gray-600 hover:font-bold items-center p-1"},[e("td",{attrs:{width:"50"}},[e("img",{directives:[{name:"preview-card",rawName:"v-preview-card",value:{stack:[t.printing.card],index:0},expression:"{stack: [printing.card], index: 0}"}],staticClass:"rounded-card cursor-help",attrs:{src:t.cardImageFromSku(t.printing.sku.sku,50)}})]),e("td",{staticClass:"pl-2 sm:pl-4"},[e("div",{staticClass:"flex items-center space-x-1"},[e("div",{directives:[{name:"preview-card",rawName:"v-preview-card",value:{stack:[t.printing.card],index:0},expression:"{stack: [printing.card], index: 0}"}],staticClass:"font-bold cursor-help help-underline"},[t._v(t._s(t.printing.card.name))]),t.printing.card.stats.resource?e("colour",{attrs:{resource:t.printing.card.stats.resource}}):t._e()],1),e("sku-finish",{attrs:{sku:t.printing.sku}}),t._v(" "+t._s(t.englishFinish(t.printing.sku.finish))+" ")],1),e("td",{staticClass:"hidden md:table-cell w-1/10"},[t._v(t._s(t.printing.sku.set.name))]),e("td",{staticClass:"hidden sm:table-cell w-1/20 text-center rarity"},[e("rarity-symbol",{attrs:{rarity:t.printing.rarity}})],1),e("td",{staticClass:"w-1/4 md:w-1/10 flex-shrink-0"},[e("card-count",{attrs:{printing:t.printing}})],1),e("td",{staticClass:"w-1/10 md:w-1/20 text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.printing.trade,expression:"printing.trade"}],staticClass:"form-checkbox h-5 w-5 text-green-500 focus:outline-none",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.printing.trade)?t._i(t.printing.trade,null)>-1:t.printing.trade},on:{click:function(r){return t.toggle(t.printing,"trade")},change:function(r){var a=t.printing.trade,n=r.target,d=!!n.checked;if(Array.isArray(a)){var c=null,i=t._i(a,c);n.checked?i<0&&t.$set(t.printing,"trade",a.concat([c])):i>-1&&t.$set(t.printing,"trade",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.printing,"trade",d)}}})]),e("td",{staticClass:"w-1/10 md:w-1/20 text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.printing.want,expression:"printing.want"}],staticClass:"form-checkbox h-5 w-5 text-green-500 focus:outline-none",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.printing.want)?t._i(t.printing.want,null)>-1:t.printing.want},on:{click:function(r){return t.toggle(t.printing,"want")},change:function(r){var a=t.printing.want,n=r.target,d=!!n.checked;if(Array.isArray(a)){var c=null,i=t._i(a,c);n.checked?i<0&&t.$set(t.printing,"want",a.concat([c])):i>-1&&t.$set(t.printing,"want",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.printing,"want",d)}}})])])},B=[],D=o(q,j,B,!1,null,null,null,null);const G=D.exports,O={components:{Printing:G,CardSearch:f,Crumbs:v,Icon:u,HeaderTitle:g,Paginator:b,Sorter:k},mixins:[y],data(){return{crumbs:[{text:"Home",link:"/"},{text:"My Collection"}],page:1,results:{},search:{view:this.$route.query.view||"all",order:this.$route.query.order||"sku",direction:this.$route.query.direction||"asc"},title:"My collection",display:"list"}},computed:{..._("session",["user"])},methods:{activeFilter(s){return this.search.view===s?"bg-white":""},filter(s){this.search.view=s,this.updateQuery({page:1,view:this.search.view})},refreshResults(s){this.results=s},sort(s){s===this.search.order?this.search.direction=this.search.direction==="asc"?"desc":"asc":this.search.direction="asc",this.search.order=s,this.updateQuery({direction:this.search.direction,order:this.search.order})},tabClasses(s){return s===this.search.view?"bg-white text-gray-700":"button-primary hover:button-secondary"},toggleDisplay(){this.display=this.display==="list"?"gallery":"list"},updatePage(s){this.updateQuery({page:s})}},mounted(){this.$root.collectionTabIndex=0},metaInfo(){return{title:this.title,meta:[{vmid:"description",name:"description",content:"Manage your Flesh & Blood card collection."}]}}};var W=function(){var t=this,e=t._self._c;return e("div",[e("header-title",{attrs:{title:"My Collection"}}),e("div",{staticClass:"crumbs"},[e("div",{staticClass:"container sm:mx-auto p-4 pb-0 flex items-center"},[e("div",{staticClass:"flex text-base"},[e("button",{staticClass:"p-2 px-4 rounded-t-lg mr-1",class:t.tabClasses("all"),on:{click:function(r){return t.filter("all")}}},[t._v("All")]),e("button",{staticClass:"p-2 px-4 rounded-t-lg mr-1",class:t.tabClasses("have"),on:{click:function(r){return t.filter("have")}}},[t._v("Have")]),e("button",{staticClass:"p-2 px-4 rounded-t-lg mr-1",class:t.tabClasses("need"),on:{click:function(r){return t.filter("need")}}},[t._v("Need")])]),e("div",{staticClass:"ml-auto"},[e("router-link",{staticClass:"font-serif uppercase hover:opacity-50",attrs:{to:{name:"user.profile.wants",params:{user:t.user.slug}}}},[e("span",{staticClass:"hidden sm:inline"},[t._v("My want/trade list")]),e("icon",{staticClass:"sm:hidden -mt-1",attrs:{size:8}},[e("path",{attrs:{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}}),e("path",{attrs:{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"}})])],1)],1)])]),e("div",{staticClass:"bg-white dark:bg-gray-800 pt-4 border-b-4 border-gray-300 dark:border-gray-600"},[e("div",{staticClass:"container sm:mx-auto sm:px-4"},[e("card-search",{attrs:{"use-case":"collection",external:{per_page:15,...t.search}},on:{"search-completed":t.refreshResults}})],1)]),e("div",{staticClass:"main-body pb-8 text-sm sm:text-base"},[e("div",{staticClass:"container sm:mx-auto"},[t.results&&t.results.data?e("div",{staticClass:"sm:px-4"},[e("div",{staticClass:"mx-auto py-4"},[e("paginator",{attrs:{results:t.results},on:{"page-selected":t.updatePage}})],1),e("table",{staticClass:"w-full bg-white dark:bg-gray-800 space-x-4 p-1 border-b-2 border-gray-300 dark:border-gray-600"},[e("thead",[e("tr",[t._m(0),e("td",{staticClass:"py-1"},[e("div",{staticClass:"flex space-x-2"},[e("sorter",{attrs:{field:"name",text:"Name",order:t.search.order,direction:t.search.direction,clicked:t.sort}}),e("span",[t._v("\\")]),e("sorter",{attrs:{field:"sku",text:"Sku",order:t.search.order,direction:t.search.direction,clicked:t.sort}})],1)]),e("td",{staticClass:"hidden md:table-cell w-1/10"},[t._v("Set/Release")]),e("td",{staticClass:"hidden sm:table-cell w-1/20"},[e("sorter",{staticClass:"justify-center",attrs:{field:"rarity",text:"Rarity",order:t.search.order,direction:t.search.direction,clicked:t.sort}})],1),e("td",{staticClass:"w-1/4 md:w-1/10 text-center"},[t._v("Total")]),e("td",{staticClass:"w-1/10 md:w-1/20 text-center"},[t._v("Trade")]),e("td",{staticClass:"w-1/10 md:w-1/20 text-center"},[t._v("Want")])])]),e("tbody",t._l(t.results.data,function(r){return e("printing",{key:r.sku.sku,attrs:{printing:r}})}),1)]),e("div",{staticClass:"py-4"},[e("paginator",{attrs:{results:t.results},on:{"page-selected":t.updatePage}})],1)]):t._e()])])],1)},E=[function(){var s=this,t=s._self._c;return t("td",{},[t("div",{staticStyle:{width:"50px"}})])}],J=o(O,W,E,!1,null,null,null,null);const Z=J.exports;export{Z as default};
